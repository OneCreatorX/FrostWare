
local ed=(e and e:FindFirstChild("Page-Editor"))or addTab("Editor","https://raw.githubusercontent.com/encharm/Font-Awesome-SVG-PNG/master/black/png/64/code.png")local DIR="editor_tabs"if not isfolder(DIR)then makefolder(DIR)end;local function fpath(n)return DIR.."/"..n..".lua"end;local function savefile(n,tx)pcall(function()writefile(fpath(n),tx or "")end)end;local function loadfiletxt(n)local ok,tx=pcall(function()if isfile(fpath(n))then return readfile(fpath(n))else return "" end end)return ok and tx or "" end;local PRIMARY=Color3.fromRGB(120,95,205)local PRIMARY_ACTIVE=Color3.fromRGB(95,75,175)local PRIMARY_LIGHT=Color3.fromRGB(155,130,245)local BTN_TEXT=C.w local K=C.k local W=C.w local MARGIN=0.03 local HEADER_H=0.09 local GAP_H=0.02 local BAR_H=0.10 local contentXScale=1-(MARGIN*2)local headerY=MARGIN local editorY=MARGIN+HEADER_H+GAP_H local barY=1-MARGIN-BAR_H local editorH=1-(editorY+BAR_H+MARGIN)local function mkbtn(p,n,t,sz,ps,zi,fn)local b=x("tb",p,{n=n,bs=0,bc=PRIMARY,tc=BTN_TEXT,tx=t,txs=13,ft=F(A.j,E.b,E.n),sz=sz or u(0,120,0,36),ps=ps or u(0,0,0,0),bt=0,zi=zi or 1,tfx=E.cx,tfy=E.cy})x("uc",b,{cr=D(0.7,0)})x("us",b,{ar=E.a,th=1})if fn then y(b,fn)end;return b end;local ICON_DIR="fw_icons"if not isfolder(ICON_DIR)then makefolder(ICON_DIR)end;local function httpget(u)local ok,body=pcall(function()if syn and syn.request then local r=syn.request({Url=u,Method="GET"})return r.Body end;if request then local r=request({Url=u,Method="GET"})return r.Body end;return game:HttpGet(u)end)return ok and body or "" end;local function toAsset(p)local a=""pcall(function()if getcustomasset then a=getcustomasset(p)elseif getsynasset then a=getsynasset(p)else a="rbxasset://"..p end end)return a end;local function ensureIcon(name,url)local p=ICON_DIR.."/"..name..".fwtex"if not isfile(p)then local b=httpget(url)pcall(function()writefile(p,b)end)end;return toAsset(p),p end;local function mkimgbtn(parent,name,asset,sz,ps,zi,fn,bg,circle)local b=Instance.new("ImageButton")b.Parent=parent;b.Name=name;b.BackgroundTransparency=1;b.BorderSizePixel=0;b.Size=sz or UDim2.new(0,120,0,36);b.Position=ps or UDim2.new(0,0,0,0);b.ZIndex=zi or 1;b.Image=asset;b.ScaleType=Enum.ScaleType.Fit;if circle then local uc=Instance.new("UICorner")uc.Parent=b;uc.CornerRadius=UDim.new(1,0)end;if fn then if y then y(b,fn)else b.MouseButton1Click:Connect(fn)end end;return b end;local tabs={}local cur="Main"local mainContent=""local hdr=x("fr",ed,{n="EdTabs",bs=0,bc=C.w,bt=1,sz=u(contentXScale,0,HEADER_H,0),ps=u(MARGIN,0,headerY,0)})x("uc",hdr,{cr=D(0.18,0)})x("us",hdr,{ar=E.a,th=1})local hll=Instance.new("UIListLayout")hll.Parent=hdr;hll.FillDirection=Enum.FillDirection.Horizontal;hll.HorizontalAlignment=Enum.HorizontalAlignment.Left;hll.VerticalAlignment=Enum.VerticalAlignment.Center;hll.Padding=UDim.new(0,6);hll.SortOrder=Enum.SortOrder.LayoutOrder;local bx=ed:FindFirstChild("EditorBox")if not bx then bx=Instance.new("TextBox")bx.Parent=ed;bx[M.n]="EditorBox";bx[M.bs]=0;bx[M.bc]=C.t1;bx[M.bt]=0;bx[M.sz]=u(contentXScale,0,editorH,0);bx[M.ps]=u(MARGIN,0,editorY,0);bx[M.tc]=W;bx[M.tfx]=E.lx;bx[M.tfy]=E.ly;bx[M.txs]=15;bx[M.txw]=true;bx.MultiLine=true;bx.ClearTextOnFocus=false;bx[M.ft]=F(R..A.i,E.b,E.n)x("uc",bx,{cr=D(0.06,0)})else bx[M.sz]=u(contentXScale,0,editorH,0)bx[M.ps]=u(MARGIN,0,editorY,0)end;local function findConsoleOut()local pc=e and e:FindFirstChild("Page-Console")if not pc then return nil end;local candidates={"ConsoleOut","Output","Out"}for _,name in ipairs(candidates)do local obj=pc:FindFirstChild(name,true)if obj and obj:IsA("TextBox")then return obj end end;for _,ch in ipairs(pc:GetDescendants())do if ch:IsA("TextBox")then return ch end end;return nil end;local function consoleWrite(line,kind)local tag="["..(kind or "info").."] "local msg=tag..tostring(line)if typeof(rconsoleprint)=="function"then pcall(function()rconsoleprint(msg.."\n")end)end;print(msg)local out=findConsoleOut()if out then local sep=((out.Text or "")~="")and"\n"or"";out.Text=(out.Text or "")..sep..msg;if out.CursorPosition then out.CursorPosition=#out.Text+1 end end end;local function restyle()for n,t in pairs(tabs)do local a=(n==cur)t.h[M.bc]=a and PRIMARY_ACTIVE or PRIMARY;if t.g then t.g.Color=a and s(PRIMARY_LIGHT,PRIMARY_ACTIVE)or s(PRIMARY,PRIMARY_ACTIVE)end;if t.sel then t.sel[M.v]=a end end end;local function selectTab(name)cur=name;if name=="Main"then bx.Text=mainContent or""else bx.Text=loadfiletxt(name)end;restyle()end;local ord=1;local function mkTab(name)local px=math.max(62,(#name*8)+(name~="Main"and 34 or 22)+20)local hold=x("fr",hdr,{n="T-"..name,bs=0,bc=PRIMARY,bt=0,sz=u(0,px,1,0),zi=2})x("uc",hold,{cr=D(0.8,0)})local st=x("us",hold,{ar=E.a,th=1})local grad=x("ug",hold,{rt=90,Color=s(PRIMARY,PRIMARY_ACTIVE)})hold.LayoutOrder=ord;ord=ord+1;local lab=x("tl",hold,{n="L",tx=name,txs=13,tc=BTN_TEXT,ft=F(A.j,E.b,E.n),bs=0,bt=1,sz=u(1,0,1,0),ps=u(0,0,0,0),tfx=E.cx,tfy=E.cy})local hit=x("tb",hold,{n="Hit",bs=0,bc=PRIMARY,tc=BTN_TEXT,tx="",txs=1,sz=u(1,0,1,0),ps=u(0,0,0,0),bt=1,zi=3})y(hit,function()selectTab(name)end)local sel=x("fr",hold,{n="Sel",bs=0,bc=PRIMARY_LIGHT,bt=0,sz=u(1,0,0,3),ps=u(0,0,1,-3),zi=4,v=false})x("uc",sel,{cr=D(1,0)})local close=nil;if name~="Main"then close=x("tb",hold,{n="X",bs=0,bc=PRIMARY_ACTIVE,tc=BTN_TEXT,ft=F(A.j,E.b,E.n),tx="X",txs=12,sz=u(0,16,0,16),ps=u(1,-22,0,7),bt=0,zi=5,tfx=E.cx,tfy=E.cy})x("uc",close,{cr=D(1,0)})y(close,function()if tabs[name]then if cur==name then cur="Main"selectTab("Main")end;pcall(function()if isfile(fpath(name))then delfile(fpath(name))end end)tabs[name]=nil;hold:Destroy()restyle()end end)end;tabs[name]={h=hold,l=lab,x=close,g=grad,st=st,sel=sel}return hold end;local ov2=x("fr",ed,{n="EdAddOv",v=false,zi=999,bs=0,bc=K,bt=0.35,sz=u(1,0,1,0),ps=u(0,0,0,0)})local blk=x("tb",ov2,{n="Block",bs=0,bt=1,sz=u(1,0,1,0),ps=u(0,0,0,0),zi=999,tx=""})local pv=x("fr",ov2,{n="EdAddPv",bs=0,bc=C.g2,bt=0,sz=u(0,300,0,140),ps=u(0.5,-150,0.5,-70),zi=1000})x("uc",pv,{cr=D(0.24,0)})x("us",pv,{ar=E.a,th=1})local nb=Instance.new("TextBox")nb.Parent=pv;nb[M.n]="NameBox"nb[M.bs]=0 nb[M.bc]=C.t1 nb[M.bt]=0 nb[M.sz]=u(0.86,0,0,34)nb[M.ps]=u(0.07,0,0.22,0)nb[M.tc]=W nb[M.tfx]=E.lx nb[M.tfy]=E.ly nb[M.txs]=15 nb[M.txw]=false nb.ClearTextOnFocus=false nb[M.ft]=F(R..A.i,E.b,E.n)x("uc",nb,{cr=D(0.24,0)})nb:GetPropertyChangedSignal("Text"):Connect(function()local t=nb.Text or"";if #t>12 then nb.Text=t:sub(1,12)end end)local okBtn=mkbtn(pv,"OK","OK",u(0,112,0,32),u(0.07,0,0.68,0),1001,function()local name=(nb.Text or"Tab"):gsub("[%c%p%s]","")if name==""then name="Tab" end;if name=="Main"then selectTab("Main")ov2[M.v]=false return end;if not tabs[name]then mkTab(name)savefile(name,"")end;selectTab(name)ov2[M.v]=false end)local cxBtn=mkbtn(pv,"CX","X",u(0,112,0,32),u(0.59,0,0.68,0),1001,function()ov2[M.v]=false end)local addAsset=ensureIcon("add_tab","https://raw.githubusercontent.com/OneCreatorX/FrostWare/refs/heads/main/icons/add%20tab.jpg")local plus=mkimgbtn(hdr,"Plus",addAsset,u(0,28,0,28),u(0,0,0,0),2147480000,function()nb.Text=""ov2[M.v]=true end,nil,true)plus.LayoutOrder=2147480000;blk.MouseButton1Click:Connect(function()ov2[M.v]=false end)local function scanAndBuild()local ok,files=pcall(function()return listfiles(DIR)end)if ok and files then for _,f in ipairs(files)do local filename=f:match("[^/\\]+$")or f;local name=filename:gsub("%.lua$","")if name~=""and name~="Main"then if not tabs[name]then mkTab(name)end end end end end;mkTab("Main")tabs["Main"].h.LayoutOrder=0;ord=1;scanAndBuild();selectTab("Main")bx:GetPropertyChangedSignal("Text"):Connect(function()if cur=="Main"then mainContent=bx.Text or""else savefile(cur,bx.Text or "")end end)local bar=x("fr",ed,{n="EdBar",bs=0,bc=C.w,bt=1,sz=u(contentXScale,0,BAR_H,0),ps=u(MARGIN,0,barY,0)})x("uc",bar,{cr=D(0.16,0)})x("us",bar,{ar=E.a,th=1})local bl=Instance.new("UIListLayout")bl.Parent=bar;bl.FillDirection=Enum.FillDirection.Horizontal;bl.Padding=UDim.new(0,10);bl.HorizontalAlignment=Enum.HorizontalAlignment.Center;bl.VerticalAlignment=Enum.VerticalAlignment.Center;local function addBarImg(name,asset,onClick)local b=mkimgbtn(bar,name,asset,UDim2.new(0.22,0,0,36),UDim2.new(0,0,0,0),1,onClick,nil,false)return b end;local icClear=ensureIcon("Clear","https://raw.githubusercontent.com/OneCreatorX/FrostWare/refs/heads/main/icons/Clear.jpg")local icPaste=ensureIcon("Paste","https://raw.githubusercontent.com/OneCreatorX/FrostWare/refs/heads/main/icons/Paste.jpg")local icExec=ensureIcon("Execute","https://raw.githubusercontent.com/OneCreatorX/FrostWare/refs/heads/main/icons/Execute.jpg")local icExecCb=ensureIcon("ExecClip","https://raw.githubusercontent.com/OneCreatorX/FrostWare/refs/heads/main/icons/Executer%20clipboard.jpg")addBarImg("Clear",icClear,function()bx.Text=""end)addBarImg("Paste",icPaste,function()local s=(getclipboard and getclipboard())or"";if #s>0 then bx.Text=s end end)addBarImg("Exec",icExec,function()local function runCode(code)if not code or code==""then return end;local fn,cerr=loadstring(code)if not fn then consoleWrite(cerr or"Compile error","error")return end;local env=setmetatable({},{__index=getfenv()})env.print=function(...)local parts={}for i=1,select("#",...)do parts[i]=tostring(select(i,...))end;consoleWrite(table.concat(parts,"\t"),"print")end;setfenv(fn,env)local ok,rerr=xpcall(fn,function(er)return debug.traceback(er,2)end)if not ok then consoleWrite(rerr,"error")end end;runCode(bx.Text or "")end)addBarImg("ExecClip",icExecCb,function()local function runCode(code)if not code or code==""then return end;local fn,cerr=loadstring(code)if not fn then consoleWrite(cerr or"Compile error","error")return end;local env=setmetatable({},{__index=getfenv()})env.print=function(...)local parts={}for i=1,select("#",...)do parts[i]=tostring(select(i,...))end;consoleWrite(table.concat(parts,"\t"),"print")end;setfenv(fn,env)local ok,rerr=xpcall(fn,function(er)return debug.traceback(er,2)end)if not ok then consoleWrite(rerr,"error")end end;local s=(getclipboard and getclipboard())or"";runCode(s)end)
