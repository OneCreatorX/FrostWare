getgenv().shared = nil
getgenv()._G = nil
getgenv().__F = getgenv().__F or {}

local se = getrenv()
se.game = cloneref(game)
se.owner = function() return nil end

local lp = cloneref(game:GetService("Players").LocalPlayer)
getgenv().__F.lp = lp
getgenv().__F.se = se

local e = getgenv().__F
e.rs = cloneref(game:GetService("RunService"))
e.ws = cloneref(workspace)
e.ts = cloneref(game:GetService("TweenService"))
e.ms = cloneref(game:GetService("MarketplaceService"))
e.ui = cloneref(game:GetService("UserInputService"))
e.ls = cloneref(game:GetService("LogService"))
e.cs = cloneref(game:GetService("CoreGui"))
e.ps = cloneref(game:GetService("Players"))
e.hs = cloneref(game:GetService("HttpService"))
e.ss = cloneref(game:GetService("SoundService"))
e.lt = cloneref(game:GetService("Lighting"))
e.db = cloneref(game:GetService("Debris"))

e.gh = gethui or function() return e.cs end
e.gc = getclipboard or function() return "" end
e.sc = setclipboard or function() end
e.if = isfile or function() return false end
e.rf = readfile or function() return "" end
e.wf = writefile or function() end
e.mf = makefolder or function() end
e.isf = isfolder or function() return false end
e.ghi = gethwid or function() return "unk" end
e.gca = getcustomasset or function() return "" end
e.req = request or syn and syn.request or http_request or function() return {StatusCode=404,Body=""} end

local g = {}
local tabs = {}
local ct = 1
local tc = 1
local td = "FW/Tabs/"
local sr = nil
local lr = nil
local co = {}
local csr = nil
local ce = true
local op, ow, oe
local ss = tick()
local tbr = nil
local tsr = nil
local pbr = nil
local ee = false

local ft = function(s)
    local h = math.floor(s/3600)
    local m = math.floor((s%3600)/60)
    s = s%60
    return h,m,s
end

local gvt = function()
    local ep = "fw_ttl.txt"
    local now = os.time()
    local saved = e.if(ep) and tonumber(e.rf(ep)) or nil
    if not saved or saved-now<=0 then
        if e.ghi and game.HttpGet then
            local success,ttl = pcall(function()
                return tonumber(game:HttpGet("https://sys.hx.site/st/"..e.ghi()))
            end)
            if success and ttl and ttl>0 then
                local et = now+ttl
                if e.wf then e.wf(ep,tostring(et)) end
                return ft(ttl)
            else 
                return 0,0,0 
            end
        else 
            return 0,0,0 
        end
    else
        local left = saved-now
        return ft(left)
    end
end

local n = function(c,p) return Instance.new(c,p) end
local c = function(o,pr) for k,v in pairs(pr) do o[k]=v end return o end
local cr = function(t,p,pr) return c(n(t,p),pr) end

local cF = function(p,pr) return cr("Frame",p,pr) end
local cT = function(p,pr) return cr("TextLabel",p,pr) end
local cB = function(p,pr) return cr("TextButton",p,pr) end
local cTB = function(p,pr) return cr("TextBox",p,pr) end
local cI = function(p,pr) return cr("ImageLabel",p,pr) end
local cIB = function(p,pr) return cr("ImageButton",p,pr) end
local cSF = function(p,pr) return cr("ScrollingFrame",p,pr) end
local cG = function(p,c1,c2,r) return c(n("UIGradient",p),{Rotation=r or 90,Color=ColorSequence.new{ColorSequenceKeypoint.new(0,c1),ColorSequenceKeypoint.new(1,c2)}}) end
local cC = function(p,r) return c(n("UICorner",p),{CornerRadius=UDim.new(r or 0,0)}) end
local cS = function(p,t,col) return c(n("UIStroke",p),{Thickness=t,Color=col,ApplyStrokeMode=Enum.ApplyStrokeMode.Border}) end
local cTC = function(p,max) return c(n("UITextSizeConstraint",p),{MaxTextSize=max}) end
local cAR = function(p,ratio) return c(n("UIAspectRatioConstraint",p),{AspectRatio=ratio}) end

local cSB = function(p,nm,txt,ico,pos,sz)
    local btn = cF(p,{BackgroundColor3=Color3.fromRGB(255,255,255),Size=sz,Position=pos,Name=nm})
    cC(btn,0.2)
    cG(btn,Color3.fromRGB(166,190,255),Color3.fromRGB(93,117,160))
    local lbl = cT(btn,{TextWrapped=true,TextSize=20,TextXAlignment=Enum.TextXAlignment.Left,TextYAlignment=Enum.TextYAlignment.Top,TextScaled=true,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal),TextColor3=Color3.fromRGB(29,29,38),BackgroundTransparency=1,Size=UDim2.new(0.65,0,0.4,0),Text=txt,Name="Lbl",Position=UDim2.new(0.25,0,0.3,0)})
    cTC(lbl,20)
    cI(btn,{ScaleType=Enum.ScaleType.Fit,Image=ico,Size=UDim2.new(0.15,0,0.4,0),BackgroundTransparency=1,Name="Ico",Position=UDim2.new(0.05,0,0.3,0)})
    local clk = cB(btn,{TextWrapped=true,TextColor3=Color3.fromRGB(0,0,0),TextSize=14,TextScaled=true,BackgroundTransparency=1,Size=UDim2.new(1,0,1,0),Name="Clk",Text="  "})
    cC(clk,0)
    cTC(clk,14)
    return clk
end

local cRB = function(p,nm,ico,pos,sz)
    local btn = cF(p,{ZIndex=2,BackgroundColor3=Color3.fromRGB(255,255,255),Size=sz,Position=pos,Name=nm})
    cC(btn,1)
    cI(btn,{ZIndex=2,ScaleType=Enum.ScaleType.Fit,Image=ico,Size=UDim2.new(0.4,0,0.4,0),BackgroundTransparency=1,Name="Ico",Position=UDim2.new(0.3,0,0.3,0)})
    cG(btn,Color3.fromRGB(166,190,255),Color3.fromRGB(93,117,160))
    local clk = cB(btn,{TextWrapped=true,TextColor3=Color3.fromRGB(0,0,0),TextSize=14,TextScaled=true,BackgroundTransparency=1,ZIndex=3,Size=UDim2.new(1,0,1,0),Name="Clk",Text="  "})
    cC(clk,0)
    cTC(clk,14)
    cAR(btn,1)
    return clk
end

local ga = function(url, fn)
    local fd = "FW/Img/"
    local pt = fd .. fn
    if not e.isf(fd) then e.mf(fd) end
    if not e.if(pt) then
        local success, data = pcall(function()
            return game:HttpGet(url)
        end)
        if not success then
            warn("Err dl img: " .. tostring(data))
            return nil
        end
        e.wf(pt, data)
    end
    return e.gca(pt)
end

local utb = function()
    if tbr and tsr and pbr then
        local elapsed = tick() - ss
        local hours = math.floor(elapsed / 3600)
        local minutes = math.floor((elapsed % 3600) / 60)
        local seconds = math.floor(elapsed % 60)
        tbr.Text = string.format("Sess: %02d:%02d:%02d", hours, minutes, seconds)
        
        local h,m,s = gvt()
        local ts = h * 3600 + m * 60 + s
        local ms = 50 * 3600
        local pct = math.min(ts / ms, 1)
        
        if ts > 0 then
            tsr.Text = string.format("Rem: %02d:%02d:%02d", h, m, s)
            tsr.TextColor3 = Color3.fromRGB(255, 255, 255)
            pbr.Size = UDim2.new(pct, 0, 1, 0)
            if pct > 0.5 then
                cG(pbr, Color3.fromRGB(100, 255, 100), Color3.fromRGB(50, 200, 50))
            elseif pct > 0.2 then
                cG(pbr, Color3.fromRGB(255, 200, 100), Color3.fromRGB(200, 150, 50))
            else
                cG(pbr, Color3.fromRGB(255, 100, 100), Color3.fromRGB(200, 50, 50))
            end
        else
            tsr.Text = "Stat: EXP"
            tsr.TextColor3 = Color3.fromRGB(255, 100, 100)
            pbr.Size = UDim2.new(0, 0, 1, 0)
        end
    end
end

local st = function()
    if not e.isf(td) then e.mf(td) end
    local td = {}
    for id, tab in pairs(tabs) do
        td[tostring(id)] = {
            name = tab.name,
            content = tab.content,
            id = tab.id
        }
    end
    td.currentTab = ct
    td.tabCounter = tc
    e.wf(td .. "tabs.json", e.hs:JSONEncode(td))
end

local lt = function()
    if e.if(td .. "tabs.json") then
        local success, data = pcall(function()
            return e.hs:JSONDecode(e.rf(td .. "tabs.json"))
        end)
        if success and data then
            ct = data.currentTab or 1
            tc = data.tabCounter or 1
            for id, ti in pairs(data) do
                if type(ti) == "table" and ti.name then
                    tabs[tonumber(id)] = {
                        name = ti.name,
                        content = ti.content,
                        id = ti.id,
                        button = nil,
                        closeButton = nil
                    }
                end
            end
            return true
        end
    end
    return false
end

local acl = function(msg, mt, cc, fe)
    if not ce then return end
    
    local ts = os.date("[%H:%M:%S]")
    local col = Color3.fromRGB(255, 255, 255)
    local pf = ""
    
    if mt == "error" then
        col = Color3.fromRGB(255, 100, 100)
        pf = "[ERR] "
    elseif mt == "warn" then
        col = Color3.fromRGB(255, 200, 100)
        pf = "[WRN] "
    elseif mt == "info" then
        col = Color3.fromRGB(100, 200, 255)
        pf = "[INF] "
    elseif mt == "editor" then
        col = Color3.fromRGB(255, 150, 255)
        pf = "[EDT] "
    end
    
    local le = {
        text = ts .. " " .. pf .. tostring(msg),
        color = col,
        canCopy = cc ~= false,
        fullText = tostring(msg),
        type = mt or "info",
        fromEditor = fe or false
    }
    
    table.insert(co, le)
    
    if #co > 200 then
        table.remove(co, 1)
    end
    
    uc()
end

local uc = function()
    if csr then
        for _, child in pairs(csr:GetChildren()) do
            if child:IsA("TextButton") then
                child:Destroy()
            end
        end
        
        local yp = 0
        for i, log in ipairs(co) do
            local lb = cB(csr, {
                BackgroundColor3 = i % 2 == 0 and Color3.fromRGB(20, 23, 30) or Color3.fromRGB(16, 19, 27),
                Size = UDim2.new(1, 0, 0, 35),
                Position = UDim2.new(0, 0, 0, yp),
                Name = "LE" .. i,
                Text = log.text,
                TextSize = 16,
                TextColor3 = log.color,
                TextXAlignment = Enum.TextXAlignment.Left,
                FontFace = Font.new("rbxassetid://11702779409", Enum.FontWeight.Medium, Enum.FontStyle.Normal),
                TextWrapped = true,
                TextScaled = false
            })
            cTC(lb, 16)
            
            lb.MouseButton1Click:Connect(function()
                if e.sc and log.canCopy then
                    e.sc(log.fullText)
                    sa("Success", "Copied!", 1)
                end
            end)
            
            yp = yp + 35
        end
        
        csr.CanvasSize = UDim2.new(0, 0, 0, yp)
        csr.CanvasPosition = Vector2.new(0, yp)
    end
end

local cc = function()
    co = {}
    uc()
end

local tc = function()
    ce = not ce
    if ce then
        acl("Console enabled", "info")
    end
    return ce
end

local cac = function()
    local at = ""
    for i, log in ipairs(co) do
        at = at .. log.text
        if i < #co then
            at = at .. "\n"
        end
    end
    if e.sc then
        e.sc(at)
        sa("Success", "All copied!", 2)
    end
end

local cbu = function()
    g["1"] = c(n("ScreenGui",e.cs),{IgnoreGuiInset=true,DisplayOrder=999999999,ScreenInsets=Enum.ScreenInsets.None,Name="FW",ZIndexBehavior=Enum.ZIndexBehavior.Sibling,ResetOnSpawn=false})
    g["2"] = cI(g["1"],{BorderSizePixel=0,BackgroundColor3=Color3.fromRGB(255,255,255),Image="rbxassetid://102455275740647",Size=UDim2.new(1,0,1,0),Visible=false,Position=UDim2.new(0,0,-0.007,0)})
    g["3"] = cF(g["1"],{Visible=false,BorderSizePixel=0,BackgroundColor3=Color3.fromRGB(16,19,27),ClipsDescendants=true,Size=UDim2.new(0.964,0,0.936,0),Position=UDim2.new(0.018,0,0.031,0),Name="UI"})
    cC(g["3"],0.04)
    cS(g["3"],10,Color3.fromRGB(35,39,54))
    g["6"] = c(n("Folder",g["3"]),{Name="Main"})
    g["7"] = cI(g["6"],{ZIndex=6,ImageColor3=Color3.fromRGB(36,42,60),Image="rbxassetid://133620562515152",Size=UDim2.new(0.314,0,0.185,0),Visible=false,ClipsDescendants=true,BackgroundTransparency=1,Name="Alert",Position=UDim2.new(0.398,0,0.074,0)})
    
    local at = cT(g["7"],{TextWrapped=true,LineHeight=0,TextSize=31,TextXAlignment=Enum.TextXAlignment.Left,TextYAlignment=Enum.TextYAlignment.Top,TextScaled=true,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal),TextColor3=Color3.fromRGB(255,255,255),BackgroundTransparency=1,Size=UDim2.new(0.505,0,0.175,0),Text="FW Notification",Position=UDim2.new(0.147,0,0.21,0)})
    cTC(at,31)
    local am = cT(g["7"],{TextWrapped=true,TextSize=23,TextXAlignment=Enum.TextXAlignment.Left,TextYAlignment=Enum.TextYAlignment.Top,TextScaled=true,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.SemiBold,Enum.FontStyle.Normal),TextColor3=Color3.fromRGB(162,177,234),BackgroundTransparency=1,Size=UDim2.new(0.45,0,0.321,0),Text="Msg content",Name="MSG",Position=UDim2.new(0.148,0,0.449,0)})
    cTC(am,23)
    local ai = cI(g["7"],{ZIndex=2,Image="rbxassetid://107516337694688",Size=UDim2.new(0.031,0,0.54,0),BackgroundTransparency=1,Position=UDim2.new(0.059,0,0.21,0)})
    cG(ai,Color3.fromRGB(166,190,255),Color3.fromRGB(121,152,207),91.1)
    cI(g["7"],{ImageColor3=Color3.fromRGB(16,19,27),Image="rbxassetid://82022759470861",Size=UDim2.new(0.067,0,0.941,0),BackgroundTransparency=1,Name="Shd",Position=UDim2.new(0.036,0,0,0)})
    cIB(g["7"],{Image="rbxassetid://88951128464748",Size=UDim2.new(0.05,0,0.16,0),BackgroundTransparency=1,Name="Ico",Position=UDim2.new(0.84,0,0.396,0)})
    cI(g["6"],{ZIndex=22,ImageColor3=Color3.fromRGB(16,19,27),Image="rbxassetid://102023075611323",Size=UDim2.new(0.019,0,1,0),BackgroundTransparency=1,Name="Shd",Position=UDim2.new(0.254,0,0,0)})
    g["11"] = cI(g["6"],{ImageTransparency=1,ImageColor3=Color3.fromRGB(13,15,20),Image="rbxassetid://76734110237026",Size=UDim2.new(0.745,0,1,0),ClipsDescendants=true,BackgroundTransparency=1,Name="Pages",Position=UDim2.new(0.255,0,0,0)})
    
    local ob = cI(g["1"],{Image="rbxassetid://132133828845126",Size=UDim2.new(0.116,0,0.208,0),Visible=false,BackgroundTransparency=1,Name="OpenBtn",Position=UDim2.new(0.442,0,0.045,0)})
    cC(ob,0)
    cI(ob,{ScaleType=Enum.ScaleType.Fit,ImageColor3=Color3.fromRGB(255,255,255),Image="rbxassetid://102761807757832",Size=UDim2.new(0.221,0,0.244,0),BackgroundTransparency=1,Position=UDim2.new(0.388,0,0.367,0)})
    local oc = cB(ob,{TextColor3=Color3.fromRGB(0,0,0),TextSize=14,BackgroundTransparency=1,ZIndex=6,Size=UDim2.new(0.441,0,0.427,0),Name="OpenClk",Text="  ",Position=UDim2.new(0.279,0,0.284,0)})
    cC(oc,0)
    c(n("Folder",g["6"]),{Name="Alerts"})
    return g, oc
end

local csb = function()
    local sb = cI(g["6"],{ImageTransparency=1,ImageColor3=Color3.fromRGB(13,15,20),Image="rbxassetid://133862668499122",Size=UDim2.new(0.25,0,1,0),BackgroundTransparency=1,Name="Sidebar"})
    
    local pf = cF(sb,{BackgroundColor3=Color3.fromRGB(20,25,32),Size=UDim2.new(0.85,0,0.12,0),Position=UDim2.new(0.075,0,0.75,0),Name="ProgressFrame"})
    cC(pf,0.15)
    cS(pf,2,Color3.fromRGB(35,39,54))
    
    local sl = cT(pf,{Text="Session Time",TextSize=14,TextColor3=Color3.fromRGB(200,200,200),BackgroundTransparency=1,Size=UDim2.new(0.9,0,0.2,0),Position=UDim2.new(0.05,0,0.05,0),TextScaled=true,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal)})
    cTC(sl,14)
    
    local tt = cT(pf,{Text="00:00:00",TextSize=16,TextColor3=Color3.fromRGB(255,255,255),BackgroundTransparency=1,Size=UDim2.new(0.9,0,0.25,0),Position=UDim2.new(0.05,0,0.25,0),TextScaled=true,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Medium,Enum.FontStyle.Normal)})
    cTC(tt,16)
    tbr = tt
    
    local pb = cF(pf,{BackgroundColor3=Color3.fromRGB(30,35,45),Size=UDim2.new(0.9,0,0.15,0),Position=UDim2.new(0.05,0,0.55,0),Name="ProgressBg"})
    cC(pb,0.1)
    
    local pr = cF(pb,{BackgroundColor3=Color3.fromRGB(100,255,100),Size=UDim2.new(1,0,1,0),Position=UDim2.new(0,0,0,0),Name="ProgressBar"})
    cC(pr,0.1)
    cG(pr,Color3.fromRGB(100,255,100),Color3.fromRGB(50,200,50))
    pbr = pr
    
    local st = cT(pf,{Text="Checking...",TextSize=12,TextColor3=Color3.fromRGB(180,180,180),BackgroundTransparency=1,Size=UDim2.new(0.9,0,0.2,0),Position=UDim2.new(0.05,0,0.75,0),TextScaled=true,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Regular,Enum.FontStyle.Normal)})
    cTC(st,12)
    tsr = st
    
    local ub = cF(sb,{BackgroundColor3=Color3.fromRGB(255,255,255),Size=UDim2.new(0.85,0,0.08,0),Position=UDim2.new(0.075,0,0.9,0),Name="UpBtn"})
    cC(ub,0.15)
    cG(ub,Color3.fromRGB(166,190,255),Color3.fromRGB(93,117,160))
    
    local ul = cT(ub,{TextWrapped=true,TextSize=18,TextXAlignment=Enum.TextXAlignment.Left,TextYAlignment=Enum.TextYAlignment.Top,TextScaled=true,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal),TextColor3=Color3.fromRGB(29,29,38),BackgroundTransparency=1,Size=UDim2.new(0.7,0,0.6,0),Text="Upgrade Plan",Name="UpLbl",Position=UDim2.new(0.25,0,0.2,0)})
    cTC(ul,18)
    cI(ub,{ScaleType=Enum.ScaleType.Fit,Image="rbxassetid://110667923648139",Size=UDim2.new(0.15,0,0.6,0),BackgroundTransparency=1,Name="UpIco",Position=UDim2.new(0.05,0,0.2,0)})
    
    local uc = cB(ub,{TextWrapped=true,TextColor3=Color3.fromRGB(0,0,0),TextSize=14,TextScaled=true,BackgroundTransparency=1,Size=UDim2.new(1,0,1,0),Name="UpClk",Text=""})
    cC(uc,0)
    cTC(uc,14)
    
    uc.MouseButton1Click:Connect(function()
        e.sc("https://discord.gg/getfrost")
    end)
    
    local function csbn(nm,txt,ico,pos,sel)
        local btn = cF(sb,{BackgroundColor3=sel and Color3.fromRGB(30,36,51) or Color3.fromRGB(31,34,50),Size=UDim2.new(0.85,0,0.08,0),Position=pos,Name=nm,BackgroundTransparency=sel and 0 or 1})
        cC(btn,0.15)
        local box = cF(btn,{ZIndex=sel and 2 or 0,BackgroundColor3=Color3.fromRGB(255,255,255),Size=UDim2.new(0.15,0,0.6,0),Position=UDim2.new(0.08,0,0.2,0),Name="Box"})
        cC(box,0.2)
        cAR(box,1)
        if sel then 
            cG(box,Color3.fromRGB(166,190,255),Color3.fromRGB(93,117,160))
        else 
            cG(box,Color3.fromRGB(66,79,113),Color3.fromRGB(36,44,63))
        end
        cI(box,{ZIndex=sel and 2 or 0,ScaleType=Enum.ScaleType.Fit,Image=ico,Size=UDim2.new(0.6,0,0.6,0),BackgroundTransparency=1,Name="Ico",Position=UDim2.new(0.2,0,0.2,0)})
        local lbl = cT(btn,{TextWrapped=true,TextSize=20,TextXAlignment=Enum.TextXAlignment.Left,TextYAlignment=Enum.TextYAlignment.Top,TextScaled=true,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal),TextColor3=Color3.fromRGB(255,255,255),BackgroundTransparency=1,Size=UDim2.new(0.6,0,0.6,0),Text=txt,Name="Lbl",Position=UDim2.new(0.3,0,0.2,0)})
        cTC(lbl,20)
        local clk = cB(btn,{TextWrapped=true,TextColor3=Color3.fromRGB(0,0,0),TextSize=14,TextScaled=true,BackgroundTransparency=1,Size=UDim2.new(1,0,1,0),Name="Clk",Text="  ",ZIndex=5})
        cC(clk,0)
        cTC(clk,14)
        return btn,clk
    end
    
    local ed,edc = csbn("Editor","Editor","rbxassetid://94595204123047",UDim2.new(0.075,0,0.2,0),true)
    local co,coc = csbn("Console","Console","rbxassetid://107390243416427",UDim2.new(0.075,0,0.3,0),false)
    local ex,exc = csbn("Extra","Extra","rbxassetid://128679881757557",UDim2.new(0.075,0,0.4,0),false)
    
    local logo = cI(sb,{ScaleType=Enum.ScaleType.Fit,Image="rbxassetid://102761807757832",Size=UDim2.new(0.2,0,0.08,0),BackgroundTransparency=1,Name="Logo",Position=UDim2.new(0.4,0,0.05,0)})
    cC(logo,0)
    
    local close = cI(sb,{ZIndex=2,ImageColor3=Color3.fromRGB(34,41,58),Image="rbxassetid://124705542662472",Size=UDim2.new(0.13,0,1,0),BackgroundTransparency=1,Name="Close",Position=UDim2.new(0.891,0,0,0)})
    local slide = cB(close,{TextWrapped=true,TextColor3=Color3.fromRGB(0,0,0),TextSize=14,TextScaled=true,BackgroundTransparency=1,Size=UDim2.new(1,0,0.189,0),Name="Slide",Text="  ",Position=UDim2.new(0,0,0.43,0)})
    cTC(slide,14)
    
    return sb,uc,edc,coc,exc,slide
end

local ced = function()
    local ep = cI(g["11"],{ImageTransparency=1,ImageColor3=Color3.fromRGB(13,15,20),Image="rbxassetid://76734110237026",Size=UDim2.new(1.001,0,1,0),ClipsDescendants=true,BackgroundTransparency=1,Name="EditorPage",Position=UDim2.new(-0.001,0,0,0)})
    
    local tb = cF(ep,{BackgroundColor3=Color3.fromRGB(16,19,27),Size=UDim2.new(1,0,0.08,0),Position=UDim2.new(0,0,0,0),Name="TabBar"})
    cC(tb,0.02)
    cS(tb,2,Color3.fromRGB(35,39,54))
    
    local ts = cSF(tb,{BackgroundTransparency=1,Size=UDim2.new(0.85,0,1,0),Position=UDim2.new(0,0,0,0),Name="TabScroll",ScrollBarThickness=0,CanvasSize=UDim2.new(0,0,0,0)})
    c(n("UIListLayout",ts),{FillDirection=Enum.FillDirection.Horizontal,SortOrder=Enum.SortOrder.LayoutOrder,Padding=UDim.new(0,2)})
    
    local at = cB(tb,{BackgroundColor3=Color3.fromRGB(166,190,255),Size=UDim2.new(0.08,0,0.7,0),Position=UDim2.new(0.9,0,0.15,0),Text="+",TextColor3=Color3.fromRGB(29,29,38),TextSize=28,Name="AddTab",FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal)})
    cC(at,0.2)
    cG(at,Color3.fromRGB(166,190,255),Color3.fromRGB(93,117,160))
    cTC(at,28)
    
    local epp = cI(ep,{ImageColor3=Color3.fromRGB(32,39,57),Image="rbxassetid://136761835814725",Size=UDim2.new(1.001,0,0.756,0),ClipsDescendants=true,BackgroundTransparency=1,Name="EditorPage",Position=UDim2.new(-0.001,0,0.08,0)})
    
    local txtb = cF(epp,{BackgroundColor3=Color3.fromRGB(24,24,32),Size=UDim2.new(1,0,0.687,0),Position=UDim2.new(0,0,0.054,0),Name="TxtBox",BackgroundTransparency=0.9})
    
    local ef = cSF(txtb,{ElasticBehavior=Enum.ElasticBehavior.Always,TopImage="rbxassetid://148970562",MidImage="rbxassetid://148970562",VerticalScrollBarInset=Enum.ScrollBarInset.Always,BackgroundColor3=Color3.fromRGB(32,31,32),Name="EditorFrame",ScrollBarImageTransparency=1,HorizontalScrollBarInset=Enum.ScrollBarInset.Always,BottomImage="rbxassetid://148970562",Size=UDim2.new(1,0,1,0),ScrollBarImageColor3=Color3.fromRGB(38,40,46),ScrollBarThickness=10,BackgroundTransparency=1})
    
    local src = cTB(ef,{CursorPosition=-1,Name="Source",TextXAlignment=Enum.TextXAlignment.Left,PlaceholderColor3=Color3.fromRGB(205,205,205),ZIndex=3,TextWrapped=true,TextTransparency=0,TextSize=20,TextColor3=Color3.fromRGB(255,255,255),TextYAlignment=Enum.TextYAlignment.Top,RichText=false,FontFace=Font.new("rbxassetid://11702779409",Enum.FontWeight.Medium,Enum.FontStyle.Normal),MultiLine=true,ClearTextOnFocus=false,ClipsDescendants=true,Size=UDim2.new(0.7,0,2,0),Position=UDim2.new(0.08,0,0,0),Text="-- FW V2 Editor\nprint('Hello World!')",BackgroundTransparency=1})
    
    local ln = cT(ef,{TextWrapped=true,TextSize=20,TextYAlignment=Enum.TextYAlignment.Top,TextScaled=true,BackgroundColor3=Color3.fromRGB(32,31,32),FontFace=Font.new("rbxassetid://11702779409",Enum.FontWeight.Regular,Enum.FontStyle.Normal),TextColor3=Color3.fromRGB(193,191,235),BackgroundTransparency=1,Size=UDim2.new(0.05,0,2,0),Text="1",Position=UDim2.new(0.021,0,-0.003,0)})
    cTC(ln,20)
    cC(ef)
    
    local btns = cI(ep,{ZIndex=2,ImageColor3=Color3.fromRGB(16,19,27),Image="rbxassetid://123590482033481",Size=UDim2.new(1.001,0,0.161,0),ClipsDescendants=true,BackgroundTransparency=1,Name="Btns",Position=UDim2.new(-0.001,0,0.836,0)})
    
    local eb = cSB(btns,"Exec","Execute Script","rbxassetid://89434276213036",UDim2.new(0.043,0,0.37,0),UDim2.new(0.15,0,0.325,0))
    local cb = cSB(btns,"Clr","Clear Editor","rbxassetid://73909411554012",UDim2.new(0.2,0,0.37,0),UDim2.new(0.15,0,0.325,0))
    local pb = cSB(btns,"Pst","Paste Clipboard","rbxassetid://133018045821797",UDim2.new(0.36,0,0.37,0),UDim2.new(0.15,0,0.325,0))
    local ecb = cSB(btns,"ExecClp","Execute Clipboard","rbxassetid://89434276213036",UDim2.new(0.52,0,0.37,0),UDim2.new(0.15,0,0.325,0))
    
    sr = src
    lr = ln
    return ep,src,ln,ts,at,eb,cb,pb,ecb
end

local ccp = function()
    local cop = cI(g["11"],{ImageTransparency=1,ImageColor3=Color3.fromRGB(13,15,20),Image="rbxassetid://76734110237026",Size=UDim2.new(1.001,0,1,0),Visible=false,ClipsDescendants=true,BackgroundTransparency=1,Name="ConsolePage",Position=UDim2.new(-0.001,0,0,0)})
    
    local title = cT(cop,{Text="Console Output",TextSize=32,TextColor3=Color3.fromRGB(255,255,255),BackgroundTransparency=1,Size=UDim2.new(1,0,0.08,0),Position=UDim2.new(0,0,0.02,0),TextScaled=true,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal)})
    cTC(title,32)
    
    local cf = cF(cop,{BackgroundColor3=Color3.fromRGB(16,19,27),Size=UDim2.new(0.95,0,0.75,0),Position=UDim2.new(0.025,0,0.12,0),Name="ConsoleFrame"})
    cC(cf,0.02)
    cS(cf,2,Color3.fromRGB(35,39,54))
    
    local cs = cSF(cf,{BackgroundColor3=Color3.fromRGB(12,15,22),Size=UDim2.new(1,0,0.85,0),Position=UDim2.new(0,0,0,0),ScrollBarThickness=8,CanvasSize=UDim2.new(0,0,0,0),Name="ConsoleScroll"})
    cC(cs,0.02)
    
    local bf = cF(cf,{BackgroundTransparency=1,Size=UDim2.new(1,0,0.15,0),Position=UDim2.new(0,0,0.85,0),Name="ButtonFrame"})
    
    local ccb = cSB(bf,"ClearConsole","Clear Console","rbxassetid://73909411554012",UDim2.new(0.02,0,0.2,0),UDim2.new(0.18,0,0.6,0))
    local cab = cSB(bf,"CopyAll","Copy All","rbxassetid://133018045821797",UDim2.new(0.22,0,0.2,0),UDim2.new(0.18,0,0.6,0))
    local tgb = cSB(bf,"Toggle","Toggle Console","rbxassetid://94595204123047",UDim2.new(0.42,0,0.2,0),UDim2.new(0.18,0,0.6,0))
    
    csr = cs
    
    ccb.MouseButton1Click:Connect(function()
        cc()
        sa("Success","Console cleared!",2)
    end)
    
    cab.MouseButton1Click:Connect(function()
        cac()
    end)
    
    tgb.MouseButton1Click:Connect(function()
        local enabled = tc()
        sa("Info", enabled and "Console enabled!" or "Console disabled!", 2)
    end)
    
    return cop
end

local cep = function()
    local exp = cI(g["11"],{ImageTransparency=1,ImageColor3=Color3.fromRGB(13,15,20),Image="rbxassetid://76734110237026",Size=UDim2.new(1.001,0,1,0),Visible=false,ClipsDescendants=true,BackgroundTransparency=1,Name="ExtraPage",Position=UDim2.new(-0.001,0,0,0)})
    
    local title = cT(exp,{Text="Extra Features",TextSize=48,TextColor3=Color3.fromRGB(255,255,255),BackgroundTransparency=1,Size=UDim2.new(1,0,0.2,0),Position=UDim2.new(0,0,0.3,0),TextScaled=true,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal)})
    cTC(title,48)
    
    return exp
end

local ul = function(src,ln)
    if src and src.Text then
        local lines = src.Text:split("\n")
        local txt = ""
        for i=1,#lines do 
            txt = txt..tostring(i)
            if i<#lines then 
                txt = txt.."\n"
            end 
        end
        if ln then 
            ln.Text = txt 
        end
    end
end

local ctab = function(ts,nm,cont)
    local td = {name=nm or "Tab "..tc,content=cont or "-- New Tab\nprint('Hello from "..(nm or "Tab "..tc).."!')",id=tc}
    
    local tf = cF(ts,{BackgroundColor3=Color3.fromRGB(20,25,32),Size=UDim2.new(0,140,0.7,0),Position=UDim2.new(0,0,0.15,0),Name="TabFrame"..td.id})
    cC(tf,0.2)
    cS(tf,1,Color3.fromRGB(35,39,54))
    cG(tf,Color3.fromRGB(166,190,255),Color3.fromRGB(93,117,160))
    
    local tb = cB(tf,{BackgroundTransparency=1,Size=UDim2.new(0.8,0,1,0),Position=UDim2.new(0,0,0,0),Text=td.name,TextColor3=Color3.fromRGB(29,29,38),TextSize=16,Name="TabBtn"..td.id,TextScaled=true,ZIndex=2,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal)})
    cTC(tb,16)
    
    local cb = cF(tf,{BackgroundColor3=Color3.fromRGB(200,100,100),Size=UDim2.new(0,18,0,18),Position=UDim2.new(1,-22,0,4),Name="CloseFrame",ZIndex=3})
    cC(cb,0.4)
    cG(cb,Color3.fromRGB(200,100,100),Color3.fromRGB(150,50,50))
    
    local cb2 = cB(cb,{BackgroundTransparency=1,Size=UDim2.new(1,0,1,0),Text="×",TextColor3=Color3.fromRGB(255,255,255),TextSize=14,Name="CloseBtn",ZIndex=4,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal)})
    cTC(cb2,14)
    
    td.button = tb
    td.closeButton = cb2
    td.frame = tf
    tabs[td.id] = td
    
    tb.MouseButton1Click:Connect(function()
        swt(td.id)
    end)
    
    cb2.MouseButton1Click:Connect(function()
        clt(td.id,ts)
    end)
    
    ts.CanvasSize = UDim2.new(0,ts.UIListLayout.AbsoluteContentSize.X,0,0)
    tc = tc+1
    st()
    return td.id,tb,cb2
end

local swt = function(tid)
    if tabs[tid] then
        if tabs[ct] and sr then 
            tabs[ct].content = sr.Text 
        end
        
        for _,tab in pairs(tabs) do     
            if tab.frame then         
                tab.frame.BackgroundColor3 = Color3.fromRGB(20,25,32)        
                cG(tab.frame,Color3.fromRGB(66,79,113),Color3.fromRGB(36,44,63))        
                if tab.button then            
                    tab.button.TextColor3 = Color3.fromRGB(255,255,255)        
                end    
            end 
        end
        
        ct = tid
        
        if tabs[tid].frame then     
            tabs[tid].frame.BackgroundColor3 = Color3.fromRGB(30,36,51)    
            cG(tabs[tid].frame,Color3.fromRGB(166,190,255),Color3.fromRGB(93,117,160))    
            if tabs[tid].button then        
                tabs[tid].button.TextColor3 = Color3.fromRGB(29,29,38)    
            end
        end
        
        if sr then 
            sr.Text = tabs[tid].content
            ul(sr,lr)
        end
        
        st()
        return true
    end
    return false
end

local clt = function(tid,ts)
    local cnt = 0
    for _ in pairs(tabs) do 
        cnt = cnt+1 
    end
    
    if cnt <= 1 then 
        sa("Info", "Cannot close last tab!", 2)
        return false
    end
    
    if tabs[tid] then
        if tabs[tid].frame then 
            tabs[tid].frame:Destroy()
        end
        tabs[tid] = nil
        
        if ct == tid then 
            for id,_ in pairs(tabs) do 
                ct = id 
                swt(id)
                break 
            end 
        end
        
        ts.CanvasSize = UDim2.new(0,ts.UIListLayout.AbsoluteContentSize.X,0,0)
        st()
        return true
    end
    return false
end

local sa = function(title,msg,dur)
    local alert = g["7"]:Clone()
    local alerts = g["6"]:FindFirstChild("Alerts")
    if alerts then
        alert.Parent = alerts
        alert.Visible = true
        alert.Name = "Alert_"..tick()
        alert:FindFirstChild("MSG").Text = msg
        alert:FindFirstChild("TextLabel").Text = title
        
        local tw = e.ts:Create(alert,TweenInfo.new(0.5,Enum.EasingStyle.Quart,Enum.EasingDirection.Out),{Position=UDim2.new(0.398,0,0.074,0)})
        tw:Play()
        
        spawn(function()
            wait(dur or 3)
            local fo = e.ts:Create(alert,TweenInfo.new(0.3,Enum.EasingStyle.Quart,Enum.EasingDirection.In),{Position=UDim2.new(0.398,0,-0.3,0)})
            fo:Play()
            fo.Completed:Connect(function()
                alert:Destroy()
            end)
        end)
    end
end

local sp = function(pn,sb)
    for _,pg in pairs(g["11"]:GetChildren()) do 
        if pg:IsA("ImageLabel") then 
            pg.Visible = false 
        end 
    end
    
    for _,btn in pairs(sb:GetChildren()) do
        if btn:IsA("Frame") and btn.Name~="UpBtn" and btn.Name~="ProgressFrame" then
            btn.BackgroundTransparency = 1
            local box = btn:FindFirstChild("Box")
            if box then 
                box.UIGradient.Color = ColorSequence.new{ColorSequenceKeypoint.new(0,Color3.fromRGB(66,79,113)),ColorSequenceKeypoint.new(1,Color3.fromRGB(36,44,63))}
            end
        end
    end
    
    local po = g["11"]:FindFirstChild(pn.."Page")
    if po then
        po.Visible = true
        local sbb = sb:FindFirstChild(pn)
        if sbb then
            sbb.BackgroundTransparency = 0
            local box = sbb:FindFirstChild("Box")
            if box then 
                box.UIGradient.Color = ColorSequence.new{ColorSequenceKeypoint.new(0,Color3.fromRGB(166,190,255)),ColorSequenceKeypoint.new(1,Color3.fromRGB(93,117,160))}
            end
        end
    end
end

local rt = function(ts)
    if lt() then
        for id, tab in pairs(tabs) do
            if tab.name and tab.content then
                local tf = cF(ts,{BackgroundColor3=Color3.fromRGB(20,25,32),Size=UDim2.new(0,140,0.7,0),Position=UDim2.new(0,0,0.15,0),Name="TabFrame"..id})
                cC(tf,0.2)
                cS(tf,1,Color3.fromRGB(35,39,54))
                cG(tf,Color3.fromRGB(66,79,113),Color3.fromRGB(36,44,63))
                
                local tb = cB(tf,{BackgroundTransparency=1,Size=UDim2.new(0.8,0,1,0),Position=UDim2.new(0,0,0,0),Text=tab.name,TextColor3=Color3.fromRGB(255,255,255),TextSize=16,Name="TabBtn"..id,TextScaled=true,ZIndex=2,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal)})
                cTC(tb,16)
                
                local cb = cF(tf,{BackgroundColor3=Color3.fromRGB(200,100,100),Size=UDim2.new(0,18,0,18),Position=UDim2.new(1,-22,0,4),Name="CloseFrame",ZIndex=3})
                cC(cb,0.4)
                cG(cb,Color3.fromRGB(200,100,100),Color3.fromRGB(150,50,50))
                
                local cb2 = cB(cb,{BackgroundTransparency=1,Size=UDim2.new(1,0,1,0),Text="×",TextColor3=Color3.fromRGB(255,255,255),TextSize=14,Name="CloseBtn",ZIndex=4,FontFace=Font.new("rbxassetid://12187365364",Enum.FontWeight.Bold,Enum.FontStyle.Normal)})
                cTC(cb2,14)
                
                tabs[id].button = tb
                tabs[id].closeButton = cb2
                tabs[id].frame = tf
                
                tb.MouseButton1Click:Connect(function()
                    swt(id)
                end)
                
                cb2.MouseButton1Click:Connect(function()
                    clt(id,ts)
                end)
            end
        end
        ts.CanvasSize = UDim2.new(0,ts.UIListLayout.AbsoluteContentSize.X,0,0)
        return true
    end
    return false
end

local show = function()
    if g["3"] then 
        g["3"].Visible = true 
    end
    if g["2"] then 
        g["2"].Visible = true 
    end
    local ob = g["1"]:FindFirstChild("OpenBtn")
    if ob then 
        ob.Visible = false 
    end
end

local hide = function()
    if g["3"] then 
        g["3"].Visible = false 
    end
    if g["2"] then 
        g["2"].Visible = false 
    end
    local ob = g["1"]:FindFirstChild("OpenBtn")
    if ob then 
        ob.Visible = true 
    end
end

op = print
ow = warn
oe = error

print = function(...)
    local args = {...}
    local msg = ""
    for i, v in ipairs(args) do
        msg = msg .. tostring(v)
        if i < #args then msg = msg .. " " end
    end
    if not ee then
        acl(msg, "info")
    end
    op(...)
end

warn = function(...)
    local args = {...}
    local msg = ""
    for i, v in ipairs(args) do
        msg = msg .. tostring(v)
        if i < #args then msg = msg .. " " end
    end
    if not ee then
        acl(msg, "warn")
    end
    ow(...)
end

error = function(...)
    local args = {...}
    local msg = ""
    for i, v in ipairs(args) do
        msg = msg .. tostring(v)
        if i < #args then msg = msg .. " " end
    end
    if not ee then
        acl(msg, "error")
    end
    oe(...)
end

e.ls.MessageOut:Connect(function(message, messageType)
    if not ee then
        if messageType == Enum.MessageType.MessageError then
            acl(message, "error")
        elseif messageType == Enum.MessageType.MessageWarning then
            acl(message, "warn")
        elseif messageType == Enum.MessageType.MessageInfo then
            acl(message, "info")
        else
            acl(message, "info")
        end
    end
end)

local function init()
    local ui, oc = cbu()
    local sb, uc, edc, coc, exc, slide = csb()
    local ed, src, ln, ts, at, eb, cb, pb, ecb = ced()
    local cop = ccp()
    local exp = cep()
    
    local function se()
        local tr = rt(ts)
        
        if not tr then
            local mt = ctab(ts, "Main", "-- FW V2 Editor\nprint('Hello World!')")
            swt(mt)
        else
            local ct = ct
            swt(ct)
        end
        
        ul(src, ln)
        
        src:GetPropertyChangedSignal("Text"):Connect(function()
            ul(src, ln)
            local ct = ct
            local tabs = tabs
            if tabs[ct] then
                tabs[ct].content = src.Text
                spawn(function()
                    wait(0.5)
                    st()
                end)
            end
        end)
        
        at.MouseButton1Click:Connect(function()
            local ni, tb, cb = ctab(ts, "New Tab", "-- New Tab\nprint('Hello!')")
            swt(ni)
        end)
    end
    
    local function sb()
        eb.MouseButton1Click:Connect(function()
            local code = src.Text
            if code and code ~= "" then
                ee = true
                local success, result = pcall(function()
                    return loadstring(code)
                end)
                if success and result then
                    local es, er = pcall(result)
                    if es then
                        acl("Script executed successfully", "editor", true, true)
                    else
                        acl("Execution error: " .. tostring(er), "error", true, true)
                    end
                else
                    acl("Compilation error: " .. tostring(result), "error", true, true)
                end
                ee = false
            end
        end)
        
        cb.MouseButton1Click:Connect(function()
            src.Text = ""
            local ct = ct
            local tabs = tabs
            if tabs[ct] then
                tabs[ct].content = ""
            end
            ul(src, ln)
            st()
        end)
        
        pb.MouseButton1Click:Connect(function()
            local clipboard = e.gc()
            if clipboard ~= "" then
                src.Text = clipboard
                local ct = ct
                local tabs = tabs
                if tabs[ct] then
                    tabs[ct].content = clipboard
                end
                ul(src, ln)
                st()
            end
        end)
        
        ecb.MouseButton1Click:Connect(function()
            local clipboard = e.gc()
            if clipboard ~= "" then
                ee = true
                local success, result = pcall(function()
                    return loadstring(clipboard)
                end)
                if success and result then
                    local es, er = pcall(result)
                    if es then
                        acl("Clipboard script executed successfully", "editor", true, true)
                    else
                        acl("Clipboard execution error: " .. tostring(er), "error", true, true)
                    end
                else
                    acl("Clipboard compilation error: " .. tostring(result), "error", true, true)
                end
                ee = false
            end
        end)
    end
    
    local function sn()
        edc.MouseButton1Click:Connect(function()
            sp("Editor", sb)
        end)
        
        coc.MouseButton1Click:Connect(function()
            sp("Console", sb)
        end)
        
        exc.MouseButton1Click:Connect(function()
            sp("Extra", sb)
        end)
        
        slide.MouseButton1Click:Connect(function()
            hide()
        end)
        
        oc.MouseButton1Click:Connect(function()
            show()
        end)
    end
    
    se()
    sb()
    sn()
    
    spawn(function()
        while wait(1) do
            utb()
        end
    end)
    
    sp("Editor", sb)
    show()
    
    spawn(function()
        wait(1)
        acl("FW Console initialized", "info")
        acl("Console captures print(), warn(), and error() automatically", "info")
        print("FW V2 loaded successfully!")
    end)
end

init()

getgenv()._G = nil
getgenv().__FW = e

return e
